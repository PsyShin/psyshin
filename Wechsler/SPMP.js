//norm

//表甲-3
AgeGroup = ["12歲 (11:9 ~ 12:2)","12歲半 (12:3 ~ 12:8)","13歲 (12:9 ~ 13:2)","13歲半 (13:3 ~ 13:8)","14歲 (13:9 ~ 14:2)","14歲半 (14:3 ~ 14:8)","15歲 (14:9 ~ 15:2)","15歲半 (15:3 ~ 15:8)","16歲 (15:9 ~ 16:2)","16歲半 (16:3 ~ 16:8)","17歲 (16:9 ~ 17:2)","17歲半 (17:3 ~ 17:8)","18歲 (17:9 ~ 18:2)","18 ~ 20歲","21 ~ 30歲","31 ~ 40歲","41 ~ 50歲","51 ~ 60歲","61 ~ 65歲","66 ~ 70歲","71 ~ 75歲","76 ~ 79歲"];
StanS_Norm = [
	[45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,71,73,75,77,79,81,83,86,90,93,96,99,102,104,107,110,112,115,117,120,123,126,129,131,134,137,140,142,144,146,148,149,150,151,152],
	[44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,70,72,74,76,78,80,82,85,89,92,95,98,101,103,106,109,111,114,116,119,122,125,128,130,133,136,138,141,143,145,147,148,149,150,151],
	[43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,71,73,75,77,79,81,84,88,91,94,97,100,102,105,108,110,113,115,118,121,124,127,129,132,135,137,139,142,144,146,147,148,149,150],
	[42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,70,72,74,76,78,80,83,86,89,92,95,98,100,103,106,109,111,114,117,120,123,126,128,131,134,136,138,141,143,145,146,147,148,149],
	[40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,64,65,67,69,71,73,75,77,79,81,84,87,90,93,96,99,102,104,107,110,112,115,118,121,124,126,129,132,134,137,140,142,144,145,146,147,148],
	[40,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,63,64,66,68,70,72,74,76,78,80,83,86,89,92,95,98,101,103,106,109,111,114,117,120,123,125,128,131,133,136,139,141,143,144,145,146,147],
	[40,40,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,64,66,68,70,72,74,76,79,81,84,87,90,93,96,99,101,104,107,109,112,115,118,121,123,126,128,131,134,137,139,141,143,144,145,146],
	[40,40,40,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,63,65,67,69,71,73,75,77,80,83,86,89,92,95,98,100,103,106,108,111,114,117,119,121,124,126,129,132,134,137,139,141,143,144,145],
	[40,40,40,40,40,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,62,64,66,68,70,72,75,77,80,83,86,89,91,94,97,100,102,104,106,109,112,114,117,119,122,124,127,129,132,135,137,139,141,143],
	[40,40,40,40,40,40,40,41,42,43,44,45,46,47,48,49,50,51,51,52,53,54,55,56,57,58,60,61,63,65,67,69,71,74,77,80,83,86,89,92,95,97,100,103,105,108,110,113,116,118,121,123,126,128,131,134,136,138,140,142],
	[40,40,40,40,40,40,40,40,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,59,60,62,64,66,68,70,72,75,78,81,84,87,90,94,96,99,102,104,107,109,112,115,117,120,123,126,128,131,133,135,137,139,141],
	[40,40,40,40,40,40,40,40,40,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,59,61,63,65,67,69,71,74,77,80,83,86,89,93,96,99,101,103,106,109,112,115,117,120,122,125,127,130,132,134,136,138,140],
	[40,40,40,40,40,40,40,40,40,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,73,76,79,82,85,88,92,95,98,101,103,106,109,111,114,117,119,122,125,127,130,132,134,136,138,140]]
PR_Norm = [
	['<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','1','1','1','1','1','1','2','2','3','4','5','6','8','10','13','18','25','32','39','47','55','61','68','75','79','84','87','91','94','96','97','98','99','99','>99','>99','>99','>99','>99','>99','>99','>99','>99'],
	['<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','1','1','1','1','1','1','2','2','3','4','5','7','9','12','16','23','30','37','45','53','58','66','73','77','82','86','90','93','95','97','98','99','99','99','>99','>99','>99','>99','>99','>99','>99','>99'],
	['<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','1','1','1','1','1','1','2','3','4','5','6','8','10','14','21','27','34','42','50','55','63','70','75','81','84','88','92','95','96','97','98','99','99','>99','>99','>99','>99','>99','>99','>99','>99'],
	['<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','1','1','1','1','1','2','2','3','4','5','7','9','13','18','23','30','37','45','50','58','66','73','77','82','87','91','94','96','97','98','99','99','99','>99','>99','>99','>99','>99','>99','>99'],
	['<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','1','1','1','1','2','3','4','5','6','8','10','14','19','25','32','39','47','55','61','68','75','79','84','88','92','95','96','97','98','99','99','>99','>99','>99','>99','>99','>99','>99'],
	['<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','1','1','1','2','2','3','4','5','7','9','13','18','23','30','37','45','53','58','66','73','77','82','87','91','94','95','97','98','99','99','>99','>99','>99','>99','>99','>99','>99'],
	['<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','1','1','1','2','2','3','4','5','8','10','14','19','25','32','39','47','53','61','68','73','79','84','88','92','94','96','97','98','99','99','>99','>99','>99','>99','>99','>99'],
	['<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','1','1','1','2','3','4','5','6','9','13','18','23','30','37','45','50','58','66','70','77','82','87','90','92','95','96','97','98','99','99','>99','>99','>99','>99','>99'],
	['<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','1','1','1','2','2','3','5','6','9','13','18','23','27','34','42','50','55','61','66','73','79','82','87','90','93','95','96','97','98','99','99','>99','>99','>99'],
	['<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','1','1','1','2','3','4','6','9','13','18','23','30','37','42','50','58','63','70','75','81','86','88','92','94','96','97','98','99','99','99','>99','>99'],
	['<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','1','1','1','2','2','3','5','7','10','14','19','25','34','39','47','55','61','68','73','79','84','87','91','94','96','97','98','99','99','99','>99','>99'],
	['<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','1','1','1','2','3','4','6','9','13','18','23','32','39','47','53','58','66','73','79','84','87','91','93','95','96','98','98','99','99','99','>99'],
	['<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','<1','1','1','1','2','2','4','5','8','12','16','21','30','37','45','53','58','66','73','77','82','87','90','93','95','96','98','98','99','99','99','>99']]

//表甲-4
PR_Norm_elder = [
	[34,36,39,42,45,48,50],
	[30,32,34,38,41,43,45],
	[15,20,26,32,37,42,45],
	[14,17,23,29,34,39,42],
	[13,16,21,27,33,38,41],
	[12,15,19,25,31,36,40],
	[11,13,16,22,27,33,37],
	[10,12,14,20,25,30,34]]

//表乙-3
Exp_Norm = [[7,3,2,1,0],[7,4,2,1,0],[7,4,2,1,1],[8,4,2,1,1],[8,5,2,1,1],[8,6,2,1,1],[9,6,2,1,1],[9,6,3,1,1],[10,6,3,1,1],[10,7,3,1,1],[10,8,3,1,1],[10,8,4,1,1],[10,9,4,1,1],[10,9,4,2,1],[11,9,4,2,1],[11,9,5,2,1],[11,10,5,2,1],[11,10,6,2,1],[11,10,6,3,1],[11,11,6,3,1],[11,11,7,3,1],[11,11,7,4,1],[11,11,7,4,2],[11,11,7,5,2],[11,11,8,5,2],[12,11,8,5,2],[12,12,8,5,2],[12,12,8,6,2],[12,12,8,6,3],[12,12,9,6,3],[12,12,9,7,3],[12,12,9,7,4],[12,12,9,8,4],[12,12,9,8,5],[12,12,9,9,5],[12,12,10,9,5],[12,12,10,10,5],[12,12,10,10,6],[12,12,11,10,6],[12,12,11,11,6],[12,12,11,11,7],[12,12,12,11,7],[12,12,12,11,8],[12,12,12,11,9],[12,12,12,11,10],[12,12,12,12,10],[12,12,12,12,11],[12,12,12,12,12]]

//表3-2
FakeLS_Cut = [1,2,3,4,5,6,7,7,7,7,7,9,9,9,9,9,10,10,10,10,10,11,11,11,11,11,12,12,12,12,12,10,10,10,10,10,8,8,8,8,8,7,7,7,7,7,6,6,6,6,6,2,2,2,2,0,0,-1,-1];

//Answer
var SPMP_Ans = [4,5,1,2,6,5,1,3,4,2,3,6,
	4,1,3,6,5,4,1,3,2,5,2,6,
	5,4,7,8,1,7,6,1,6,8,2,6,
	2,1,1,2,5,8,7,6,3,4,2,5,
	7,6,4,3,4,8,3,1,5,2,5,3]



function TestBtn(){
	var RawInText = document.getElementsByName('RawIn');
	var clnameText = document.getElementsByName("clname");
	var BasicInfo_AgeText = document.getElementsByName('BasicInfo_Age');
	var RS_inputText = document.getElementsByName('RS_input');
	var Client1 = [4,5,1,2,6,5,1,3,4,2,3,6,
		4,1,3,6,5,4,1,3,2,5,2,6,
		5,4,7,8,1,7,6,1,6,8,3,5,
		2,1,1,2,5,8,7,6,3,4,3,6,
		7,6,4,3,4,8,3,2,6,3,6,4];
	var Client1_Text = ["許生","Shin臨床心理師","0800092000"];
	var Client1_Age = [95,1,20,81,4,4,13,9,16];
	var Client1_RS = [12,12,10,10,7];


	for(let i=0; i<60; i++) RawInText[i].value = Client1[i];
	for(let i=0; i<3; i++) clnameText[i].value = Client1_Text[i];
	for(let i=0; i<9; i++) BasicInfo_AgeText[i].value = Client1_Age[i];
	for(let i=0; i<5; i++) RS_inputText[i].value = Client1_RS[i];

}


function RSBtn(){
	var RS_Sum = [0,0,0,0,0];
	var RawInText = document.getElementsByName('RawIn');
	var RS_inputText = document.getElementsByName('RS_input');

	for(let i=0; i<60; i++){
		if(Number(RawInText[i].value) < 0){
			alert("填答超出範圍，哭哭，請檢查受是否輸入錯誤");
			return;
		}
		if(i < 12){
			if(Number(RawInText[i].value) > 6){
				alert("填答超出範圍，哭哭，請檢查受是否輸入錯誤");
				return;
			}
		}else{
			if(Number(RawInText[i].value) > 8){
				alert("填答超出範圍，哭哭，請檢查受是否輸入錯誤");
				return;
			}
		}

		if(Number(RawInText[i].value) == SPMP_Ans[i]) {
			RS_Sum[Math.floor(i/12)] += 1;
		}else{
			RawInText[i].style['background-color'] = '#FFEEDD';
		}
	}

	for(let i=0; i<5; i++) RS_inputText[i].value = RS_Sum[i];
}

function ReloadBtn(){
	document.location.reload();
}


function AgeCalBtn(){
	var BasicInfo_AgeText = document.getElementsByName('BasicInfo_Age');
	var ClientAge = [0,0,0];

	ClientAge[0] = Number(BasicInfo_AgeText[0].value) - Number(BasicInfo_AgeText[3].value);
	ClientAge[1] = Number(BasicInfo_AgeText[1].value) - Number(BasicInfo_AgeText[4].value);
	ClientAge[2] = Number(BasicInfo_AgeText[2].value) - Number(BasicInfo_AgeText[5].value);

	if(ClientAge[2] < 0){
		ClientAge[2] += 30;
		ClientAge[1] -= 1;
	}

	if(ClientAge[1] < 0){
		ClientAge[1] += 12;
		ClientAge[0] -= 1;
	}

	if(ClientAge[0] < 1) alert('年齡輸錯了哦！');

	for(let i=0; i<4; i++) BasicInfo_AgeText[i+6].value = ClientAge[i];
}


function FiveRank(PR_input){
	if(PR_input == "<1"){
		return "E";
	}else if(PR_input == ">99"){
		return "A";
	}else{
		if(Number(PR_input) >= 95) return ["A", "智能優異"]; else if(Number(PR_input) >= 90) return ["B+","智能明確地在平均數以上"]; else if(Number(PR_input) >= 75) return ["B","智能明確地在平均數以上"]; else if(Number(PR_input) >= 51) return ["C+", "平均智能"]; else if(Number(PR_input) >= 50) return ["C","平均智能"]; else if(Number(PR_input) >= 25) return ["C-","平均智能"]; else if(Number(PR_input) >= 11) return ["D","智能明確地在平均數以下"]; else if(Number(PR_input) >= 6) return ["D-","智能明確地在平均數以下"]; else return ["E","智能障礙"];
	}
}

function Elder_Norm(ClAG, ClTS){
	if(ClTS < PR_Norm_elder[ClAG][0]){
		return ["<5", "E", "智能障礙"];
	}else if(ClTS == PR_Norm_elder[ClAG][0]){
		return ["5","E", "智能障礙"];
	}else if(ClTS < PR_Norm_elder[ClAG][1]){
		return ["6 ~ 9", "D-", "智能明確地在平均數以下"];
	}else if(ClTS == PR_Norm_elder[ClAG][1]){
		return ["10","D-", "智能明確地在平均數以下"];
	}else if(ClTS < PR_Norm_elder[ClAG][2]){
		return ["11 ~ 24", "D", "智能明確地在平均數以下"];
	}else if(ClTS == PR_Norm_elder[ClAG][2]){
		return ["25","C-", "平均智能"];
	}else if(ClTS < PR_Norm_elder[ClAG][3]){
		return ["26 ~ 49", "C-", "平均智能"];
	}else if(ClTS == PR_Norm_elder[ClAG][3]){
		return ["50","C", "平均智能"];
	}else if(ClTS < PR_Norm_elder[ClAG][4]){
		return ["51 ~ 74", "C+", "平均智能"];
	}else if(ClTS == PR_Norm_elder[ClAG][4]){
		return ["75","B", "智能明確地在平均數以上"];
	}else if(ClTS < PR_Norm_elder[ClAG][5]){
		return ["76 ~ 89", "B", "智能明確地在平均數以上"];
	}else if(ClTS == PR_Norm_elder[ClAG][5]){
		return ["90","B+", "智能明確地在平均數以上"];
	}else if(ClTS < PR_Norm_elder[ClAG][6]){
		return ["91 ~ 94", "B+", "智能明確地在平均數以上"];
	}else if(ClTS == PR_Norm_elder[ClAG][6]){
		return ["95","A", "智能優異"];
	}else{
		return [">95", "A", "智能優異"];
	}
}


function SubmitBtn(){
//	document.getElementById('testText').innerHTML = ;

//get input
	var RS_inputText = document.getElementsByName("RS_input"); 
	var RS_showText = document.getElementsByName("RS_show");
	var ES_showText = document.getElementsByName("ES_show");
	var DS_showText = document.getElementsByName("DS_show");
	var Expl_showText = document.getElementsByName("Expl_show");
	var Dec_showText = document.getElementsByName("Dec_show");
	var Easy_showText = document.getElementsByName("Easy_show");
	var RawInText = document.getElementsByName('RawIn');
	var RS_input = [];
	var Total_Score = 0;

// AgeGroup
	var ClAge = document.getElementsByName("BasicInfo_Age");
	var ClAgeGrp = (ClAge[6].value-12)*2;
	if(ClAge[7].value > 8) {ClAgeGrp += 2;} else if(ClAge[7].value > 2) {ClAgeGrp += 1;}

	for(let i=0; i<5; i++) if(RS_inputText[i].value) {
		RS_input.push(Number(RS_inputText[i].value));
		Total_Score += Number(RS_inputText[i].value);
	}
	if(RS_input.length < 5) {
		alert("請先於上方點選總分試算或手動輸入(需5個分數都有)，接著再送出哦！");
		return;
	}

	Expl_showText[0].innerHTML = Total_Score;

	for(let i=0; i<5; i++) {
		RS_showText[i].innerHTML = RS_input[i];
		ES_showText[i].innerHTML = Exp_Norm[Total_Score - 13][i];
		DS_showText[i].innerHTML = RS_input[i] - Exp_Norm[Total_Score - 13][i];
	}

	if(ClAgeGrp < 19){
		if(ClAgeGrp > 12) ClAgeGrp = 12;
		Expl_showText[1].innerHTML = StanS_Norm[ClAgeGrp][Total_Score-1];
		Expl_showText[2].innerHTML = PR_Norm[ClAgeGrp][Total_Score-1];
		Expl_showText[3].innerHTML = FiveRank(PR_Norm[ClAgeGrp][Total_Score-1])[0];
		Expl_showText[4].innerHTML = FiveRank(PR_Norm[ClAgeGrp][Total_Score-1])[1];
	}else{
		Expl_showText[1].innerHTML = "NA";
		if(ClAge[6].value > 75) ClAgeGrp = 7; else if(ClAge[6].value > 70) ClAgeGrp = 6; else if(ClAge[6].value > 65) ClAgeGrp = 5; else if(ClAge[6].value > 60) ClAgeGrp = 4; else if(ClAge[6].value > 50) ClAgeGrp = 3; else if(ClAge[6].value > 40) ClAgeGrp = 2; else if(ClAge[6].value > 30) ClAgeGrp = 1; else ClAgeGrp = 0;
		Expl_showText[2].innerHTML = Elder_Norm(ClAgeGrp, Total_Score)[0];
		Expl_showText[3].innerHTML = Elder_Norm(ClAgeGrp, Total_Score)[1];
		Expl_showText[4].innerHTML = Elder_Norm(ClAgeGrp, Total_Score)[2];
	}
	
//	fake low score
	var FakeLS = [(2 * RS_input[0]) + RS_input[1]] - [RS_input[3] + (2 * RS_input[4])]
	Dec_showText[0].innerHTML = FakeLS;
	Dec_showText[2].innerHTML = FakeLS_Cut[Total_Score-2];
	if(FakeLS < FakeLS_Cut[Total_Score-2]){
		Dec_showText[1].innerHTML = "<";
		Dec_showText[3].innerHTML = "減少值小於切斷值，故應有偽裝之嫌";
	}else{
		Dec_showText[1].innerHTML = "≥";
		Dec_showText[3].innerHTML = "減少值未小於切斷值，故應無偽裝之嫌";
	}

	for(let i=0; i<3; i++){
		if(Number(RawInText[[2,3,12][i]].value) == SPMP_Ans[[2,3,12][i]]) Easy_showText[i].innerHTML = "回答正確"; else Easy_showText[i].innerHTML = "回答錯誤";
	}
}
